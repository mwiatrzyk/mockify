stages:
    - test
    - package
    - deploy

before_script:
    - apt-get update -qy
    - apt-get install -y python3-pip
    - pip3 install -r requirements.txt

build_docs:
    stage: test
    script:
        - cd docs
        - make html

run_tests:
    stage: test
    script:
        - pytest

make_package:
    stage: package
    script:
        - python3 setup.py sdist bdist_wheel
    only:
        - tags
    except:
        - branches
